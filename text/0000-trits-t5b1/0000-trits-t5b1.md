+ Feature name: `trits-t5b1`
+ Start date: 2019-09-25
+ RFC PR: [iotaledger/bee-rfcs#13](https://github.com/iotaledger/bee-rfcs/pull/13)
+ Bee issue: [iotaledger/bee#61](https://github.com/iotaledger/bee/issues/61)

# Summary

This RFC proposes an encoding that packs `5` `trits` to a single `byte`. It may be referred to as `5t/1b`, `5t1b`, `t5/b1`, `t5b1`, `5/1`, `10/2`, ... To comply with most languages identifier rules, we'll prefer using `t5b1`.

This encoding follows the RFC#10.

# Motivation

A `byte` is composed of `8` `bits` that can hold `2^8 = 256` different values. On the other hand, `6` `trits` can hold `3^6 = 729` values while `5` `trits` can hold `3^5 = 243` values. The maximum number of `trits` a `byte` can hold is then `5`.

As this is the most memory-efficient way to encode `trits` in `bytes`, `t5b1` is often used for network communication to increase throughput and for storage to reduce memory consumption.

# Detailed design

For efficient conversions, we can make use of a LookUp Table (LUT), but because this LUT can bee too heavy (`1.2kb`) for some systems with a very limited amount of memory, we also present algorithms that do not use it.

We give the `t5b1` LUT as a reference, it contains the 243 possible values ordered like this: `0`, `1`, ... `120`, `121`, `-121`, `-120`, ... `-2`, `-1`.

```rust
[
    [ 0, 0, 0, 0, 0 ],     [ 1, 0, 0, 0, 0 ],     [ -1, 1, 0, 0, 0 ],     [ 0, 1, 0, 0, 0 ],     [ 1, 1, 0, 0, 0 ],
    [ -1, -1, 1, 0, 0 ],   [ 0, -1, 1, 0, 0 ],    [ 1, -1, 1, 0, 0 ],     [ -1, 0, 1, 0, 0 ],    [ 0, 0, 1, 0, 0 ],
    [ 1, 0, 1, 0, 0 ],     [ -1, 1, 1, 0, 0 ],    [ 0, 1, 1, 0, 0 ],      [ 1, 1, 1, 0, 0 ],     [ -1, -1, -1, 1, 0 ],
    [ 0, -1, -1, 1, 0 ],   [ 1, -1, -1, 1, 0 ],   [ -1, 0, -1, 1, 0 ],    [ 0, 0, -1, 1, 0 ],    [ 1, 0, -1, 1, 0 ],
    [ -1, 1, -1, 1, 0 ],   [ 0, 1, -1, 1, 0 ],    [ 1, 1, -1, 1, 0 ],     [ -1, -1, 0, 1, 0 ],   [ 0, -1, 0, 1, 0 ],
    [ 1, -1, 0, 1, 0 ],    [ -1, 0, 0, 1, 0 ],    [ 0, 0, 0, 1, 0 ],      [ 1, 0, 0, 1, 0 ],     [ -1, 1, 0, 1, 0 ],
    [ 0, 1, 0, 1, 0 ],     [ 1, 1, 0, 1, 0 ],     [ -1, -1, 1, 1, 0 ],    [ 0, -1, 1, 1, 0 ],    [ 1, -1, 1, 1, 0 ],
    [ -1, 0, 1, 1, 0 ],    [ 0, 0, 1, 1, 0 ],     [ 1, 0, 1, 1, 0 ],      [ -1, 1, 1, 1, 0 ],    [ 0, 1, 1, 1, 0 ],
    [ 1, 1, 1, 1, 0 ],     [ -1, -1, -1, -1, 1 ], [ 0, -1, -1, -1, 1 ],   [ 1, -1, -1, -1, 1 ],  [ -1, 0, -1, -1, 1 ],
    [ 0, 0, -1, -1, 1 ],   [ 1, 0, -1, -1, 1 ],   [ -1, 1, -1, -1, 1 ],   [ 0, 1, -1, -1, 1 ],   [ 1, 1, -1, -1, 1 ],
    [ -1, -1, 0, -1, 1 ],  [ 0, -1, 0, -1, 1 ],   [ 1, -1, 0, -1, 1 ],    [ -1, 0, 0, -1, 1 ],   [ 0, 0, 0, -1, 1 ],
    [ 1, 0, 0, -1, 1 ],    [ -1, 1, 0, -1, 1 ],   [ 0, 1, 0, -1, 1 ],     [ 1, 1, 0, -1, 1 ],    [ -1, -1, 1, -1, 1 ],
    [ 0, -1, 1, -1, 1 ],   [ 1, -1, 1, -1, 1 ],   [ -1, 0, 1, -1, 1 ],    [ 0, 0, 1, -1, 1 ],    [ 1, 0, 1, -1, 1 ],
    [ -1, 1, 1, -1, 1 ],   [ 0, 1, 1, -1, 1 ],    [ 1, 1, 1, -1, 1 ],     [ -1, -1, -1, 0, 1 ],  [ 0, -1, -1, 0, 1 ],
    [ 1, -1, -1, 0, 1 ],   [ -1, 0, -1, 0, 1 ],   [ 0, 0, -1, 0, 1 ],     [ 1, 0, -1, 0, 1 ],    [ -1, 1, -1, 0, 1 ],
    [ 0, 1, -1, 0, 1 ],    [ 1, 1, -1, 0, 1 ],    [ -1, -1, 0, 0, 1 ],    [ 0, -1, 0, 0, 1 ],    [ 1, -1, 0, 0, 1 ],
    [ -1, 0, 0, 0, 1 ],    [ 0, 0, 0, 0, 1 ],     [ 1, 0, 0, 0, 1 ],      [ -1, 1, 0, 0, 1 ],    [ 0, 1, 0, 0, 1 ],
    [ 1, 1, 0, 0, 1 ],     [ -1, -1, 1, 0, 1 ],   [ 0, -1, 1, 0, 1 ],     [ 1, -1, 1, 0, 1 ],    [ -1, 0, 1, 0, 1 ],
    [ 0, 0, 1, 0, 1 ],     [ 1, 0, 1, 0, 1 ],     [ -1, 1, 1, 0, 1 ],     [ 0, 1, 1, 0, 1 ],     [ 1, 1, 1, 0, 1 ],
    [ -1, -1, -1, 1, 1 ],  [ 0, -1, -1, 1, 1 ],   [ 1, -1, -1, 1, 1 ],    [ -1, 0, -1, 1, 1 ],   [ 0, 0, -1, 1, 1 ],
    [ 1, 0, -1, 1, 1 ],    [ -1, 1, -1, 1, 1 ],   [ 0, 1, -1, 1, 1 ],     [ 1, 1, -1, 1, 1 ],    [ -1, -1, 0, 1, 1 ],
    [ 0, -1, 0, 1, 1 ],    [ 1, -1, 0, 1, 1 ],    [ -1, 0, 0, 1, 1 ],     [ 0, 0, 0, 1, 1 ],     [ 1, 0, 0, 1, 1 ],
    [ -1, 1, 0, 1, 1 ],    [ 0, 1, 0, 1, 1 ],     [ 1, 1, 0, 1, 1 ],      [ -1, -1, 1, 1, 1 ],   [ 0, -1, 1, 1, 1 ],
    [ 1, -1, 1, 1, 1 ],    [ -1, 0, 1, 1, 1 ],    [ 0, 0, 1, 1, 1 ],      [ 1, 0, 1, 1, 1 ],     [ -1, 1, 1, 1, 1 ],
    [ 0, 1, 1, 1, 1 ],     [ 1, 1, 1, 1, 1 ],     [ -1, -1, -1, -1, -1 ], [ 0, -1, -1, -1, -1 ], [ 1, -1, -1, -1, -1 ],
    [ -1, 0, -1, -1, -1 ], [ 0, 0, -1, -1, -1 ],  [ 1, 0, -1, -1, -1 ],   [ -1, 1, -1, -1, -1 ], [ 0, 1, -1, -1, -1 ],
    [ 1, 1, -1, -1, -1 ],  [ -1, -1, 0, -1, -1 ], [ 0, -1, 0, -1, -1 ],   [ 1, -1, 0, -1, -1 ],  [ -1, 0, 0, -1, -1 ],
    [ 0, 0, 0, -1, -1 ],   [ 1, 0, 0, -1, -1 ],   [ -1, 1, 0, -1, -1 ],   [ 0, 1, 0, -1, -1 ],   [ 1, 1, 0, -1, -1 ],
    [ -1, -1, 1, -1, -1 ], [ 0, -1, 1, -1, -1 ],  [ 1, -1, 1, -1, -1 ],   [ -1, 0, 1, -1, -1 ],  [ 0, 0, 1, -1, -1 ],
    [ 1, 0, 1, -1, -1 ],   [ -1, 1, 1, -1, -1 ],  [ 0, 1, 1, -1, -1 ],    [ 1, 1, 1, -1, -1 ],   [ -1, -1, -1, 0, -1 ],
    [ 0, -1, -1, 0, -1 ],  [ 1, -1, -1, 0, -1 ],  [ -1, 0, -1, 0, -1 ],   [ 0, 0, -1, 0, -1 ],   [ 1, 0, -1, 0, -1 ],
    [ -1, 1, -1, 0, -1 ],  [ 0, 1, -1, 0, -1 ],   [ 1, 1, -1, 0, -1 ],    [ -1, -1, 0, 0, -1 ],  [ 0, -1, 0, 0, -1 ],
    [ 1, -1, 0, 0, -1 ],   [ -1, 0, 0, 0, -1 ],   [ 0, 0, 0, 0, -1 ],     [ 1, 0, 0, 0, -1 ],    [ -1, 1, 0, 0, -1 ],
    [ 0, 1, 0, 0, -1 ],    [ 1, 1, 0, 0, -1 ],    [ -1, -1, 1, 0, -1 ],   [ 0, -1, 1, 0, -1 ],   [ 1, -1, 1, 0, -1 ],
    [ -1, 0, 1, 0, -1 ],   [ 0, 0, 1, 0, -1 ],    [ 1, 0, 1, 0, -1 ],     [ -1, 1, 1, 0, -1 ],   [ 0, 1, 1, 0, -1 ],
    [ 1, 1, 1, 0, -1 ],    [ -1, -1, -1, 1, -1 ], [ 0, -1, -1, 1, -1 ],   [ 1, -1, -1, 1, -1 ],  [ -1, 0, -1, 1, -1 ],
    [ 0, 0, -1, 1, -1 ],   [ 1, 0, -1, 1, -1 ],   [ -1, 1, -1, 1, -1 ],   [ 0, 1, -1, 1, -1 ],   [ 1, 1, -1, 1, -1 ],
    [ -1, -1, 0, 1, -1 ],  [ 0, -1, 0, 1, -1 ],   [ 1, -1, 0, 1, -1 ],    [ -1, 0, 0, 1, -1 ],   [ 0, 0, 0, 1, -1 ],
    [ 1, 0, 0, 1, -1 ],    [ -1, 1, 0, 1, -1 ],   [ 0, 1, 0, 1, -1 ],     [ 1, 1, 0, 1, -1 ],    [ -1, -1, 1, 1, -1 ],
    [ 0, -1, 1, 1, -1 ],   [ 1, -1, 1, 1, -1 ],   [ -1, 0, 1, 1, -1 ],    [ 0, 0, 1, 1, -1 ],    [ 1, 0, 1, 1, -1 ],
    [ -1, 1, 1, 1, -1 ],   [ 0, 1, 1, 1, -1 ],    [ 1, 1, 1, 1, -1 ],     [ -1, -1, -1, -1, 0 ], [ 0, -1, -1, -1, 0 ],
    [ 1, -1, -1, -1, 0 ],  [ -1, 0, -1, -1, 0 ],  [ 0, 0, -1, -1, 0 ],    [ 1, 0, -1, -1, 0 ],   [ -1, 1, -1, -1, 0 ],
    [ 0, 1, -1, -1, 0 ],   [ 1, 1, -1, -1, 0 ],   [ -1, -1, 0, -1, 0 ],   [ 0, -1, 0, -1, 0 ],   [ 1, -1, 0, -1, 0 ],
    [ -1, 0, 0, -1, 0 ],   [ 0, 0, 0, -1, 0 ],    [ 1, 0, 0, -1, 0 ],     [ -1, 1, 0, -1, 0 ],   [ 0, 1, 0, -1, 0 ],
    [ 1, 1, 0, -1, 0 ],    [ -1, -1, 1, -1, 0 ],  [ 0, -1, 1, -1, 0 ],    [ 1, -1, 1, -1, 0 ],   [ -1, 0, 1, -1, 0 ],
    [ 0, 0, 1, -1, 0 ],    [ 1, 0, 1, -1, 0 ],    [ -1, 1, 1, -1, 0 ],    [ 0, 1, 1, -1, 0 ],    [ 1, 1, 1, -1, 0 ],
    [ -1, -1, -1, 0, 0 ],  [ 0, -1, -1, 0, 0 ],   [ 1, -1, -1, 0, 0 ],    [ -1, 0, -1, 0, 0 ],   [ 0, 0, -1, 0, 0 ],
    [ 1, 0, -1, 0, 0 ],    [ -1, 1, -1, 0, 0 ],   [ 0, 1, -1, 0, 0 ],     [ 1, 1, -1, 0, 0 ],    [ -1, -1, 0, 0, 0 ],
    [ 0, -1, 0, 0, 0 ],    [ 1, -1, 0, 0, 0 ],    [ -1, 0, 0, 0, 0 ]
]
```

## Encoding

WIP

## Decoding

### With LUT

Decoding a `byte` into `5` `trits` with the help of the `LUT` is fairly simple:
- if the `byte` is positive, use it as an index for the `LUT` e.g. if the byte is `42` `LUT[42] = [ 0, -1, -1, -1, 1 ]` and `0 * 3^0 + (-1) * 3^1 + (-1) * 3^2 + (-1) * 3^3 + 1 * 3^4 = 42`.

### Without LUT

WIP

# Drawbacks

WIP

# Rationale and alternatives

WIP

# Unresolved questions

WIP
